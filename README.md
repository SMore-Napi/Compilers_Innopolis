# Compiler Construction S22 course
Compiler implementation for the Functional Language.
> Semester 6, 3rd study-year, Innopolis University.

This is a project assignment about creating a compiler for the toy functional language (similar to Lisp).

*Haskell team* B19-SD-01 members
- Roman Soldatov 
- Daniil Livitin	
- Timur Nugaev	
- Mikhail Martovitsky


## üìå General usage
The program can run with provided command-line arguments if you execute it from a terminal. You can specify the path to the source program and the compiler compiles it. Alternatively, in the [Main.java](/src/main/java/Main.java) file, you can simply specify the path in `defaultPath` variable without providing any argument in a command line: `String defaultPath = <path to the source program>`.

## üôÇ Lexical analysis
In the [lexical_analysis](/src/main/java/lexical_analysis) folder, you can find a **Lexer** that tokenizes an input from the source program file. The lexer was automatically created with the use of a [JFlex](https://jflex.de) scanner. Tokens are defined in a [lexer.flex](/src/main/java/lexical_analysis/lexer.flex) file. Their class representation is stored in the [tokens](/src/main/java/lexical_analysis/tokens) folder.

Run `jflex lexer.flex` command in your terminal to generate a [Lexer.java](/src/main/java/lexical_analysis/Lexer.java) java file. We are using `lexer.tokenize()` and `lexer.getTokens` to parse and get a list of all found tokens.

## üòê Syntax analysis
In the [syntax_analysis](/src/main/java/syntax_analysis) folder, you can fina a **Parser** which creates AST via `Parser.makeAST(<sourceProgramPath>)` method. This parser was generated by [Bison](https://www.gnu.org/software/bison/). The grammar is described in [Parser.y](/src/main/java/syntax_analysis/Parser.y) file. AST contains nodes that represent particular syntax subtrees. You can find them in the [node](/src/main/java/syntax_analysis/node) folder.

We use [LexerAdapter.java](/src/main/java/syntax_analysis/LexerAdapter.java) class which connects our [Lexer.java](/src/main/java/lexical_analysis/Lexer.java) and implements necessary methods from `Parser.Lexer` [interface](https://www.gnu.org/software/bison/manual/bison.html#Java-Parser-Interface).

Run `bison Parser.y -L java` to create [Parser.java](/src/main/java/syntax_analysis/Parser.java) parser.

## üòß Interpreter
In the [interpreter](/src/main/java/interpreter) package there are classes related to AST interpreteation. 
- [AtomsTable.java](/src/main/java/interpreter/AtomsTable.java) saves defined atoms and their values. This class is represented as a singleton. Atoms are stored in some local context. Atoms with similar name shadows atoms from outer scope. Each local context is perpesented as a HashMap. The hirerachy of local contexts is presented as a Stack. When you enter into some function or loop the interpreter calls `introduceLocalContext()` function to create a new temporary local context which will be deleted after leaving the form (`leaveLocalContext()` will be called).
- [FunctionsTable.java](/src/main/java/interpreter/FunctionsTable.java) is similar to [AtomsTable.java](/src/main/java/interpreter/AtomsTable.java), but it stores defined user-functions.
- [PredefinedFunction.java](/src/main/java/interpreter/PredefinedFunction.java) and [DefinedFunction.java](/src/main/java/interpreter/DefinedFunction.java) classes are utility functions to interpret a list as a function call and evaluate it.
